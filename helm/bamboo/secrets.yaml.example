# Kubernetes Secrets for Bamboo
# DO NOT COMMIT THIS FILE WITH REAL VALUES
# Copy to secrets.yaml and update with your actual credentials
# Then apply with: kubectl apply -f secrets.yaml -n bamboo

---
apiVersion: v1
kind: Secret
metadata:
  name: bamboo-db-credentials
  namespace: bamboo
type: Opaque
stringData:
  username: bamboo
  password: "BambooDBPassword789!@#$"  # Replace with actual password from vault

---
apiVersion: v1
kind: Secret
metadata:
  name: bamboo-admin-credentials
  namespace: bamboo
type: Opaque
stringData:
  username: admin
  password: "AdminPassword123!@#$"  # Replace with secure password
  displayName: "Bamboo Administrator"
  emailAddress: "admin@example.com"

---
apiVersion: v1
kind: Secret
metadata:
  name: bamboo-security-token
  namespace: bamboo
type: Opaque
stringData:
  security-token: "generate-random-token-here"  # Generate with: openssl rand -base64 32

---
# Optional: Bamboo license secret
# Get your license from: https://my.atlassian.com
apiVersion: v1
kind: Secret
metadata:
  name: bamboo-license
  namespace: bamboo
type: Opaque
stringData:
  license-key: |
    PASTE_YOUR_BAMBOO_LICENSE_KEY_HERE

---
# =============================================================================
# TLS/SSL Certificate Configuration (CHOOSE ONE OPTION)
# =============================================================================
#
# OPTION 1: Use your own certificate (manual)
# - Create this secret with your certificate files
# - Update values-production.yaml: comment out cert-manager annotation
#
# OPTION 2: Use cert-manager (automated)
# - Delete/don't create this secret
# - Update values-production.yaml: uncomment cert-manager annotation
# - cert-manager will automatically create the bamboo-tls secret
#
# =============================================================================

# OPTION 1: Manual TLS Secret (use your own certificate)
# Method A: Create from files (recommended)
# Run this command instead of applying this YAML:
#   kubectl create secret tls bamboo-tls \
#     --cert=/path/to/your/certificate.crt \
#     --key=/path/to/your/private.key \
#     --namespace bamboo

# Method B: Create from YAML (paste your certificate content below)
apiVersion: v1
kind: Secret
metadata:
  name: bamboo-tls
  namespace: bamboo
type: kubernetes.io/tls
stringData:
  # Your SSL certificate (can include intermediate certificates)
  tls.crt: |
    -----BEGIN CERTIFICATE-----
    MIIDXTCCAkWgAwIBAgIJAKJ3vQNxKqVxMA0GCSqGSIb3DQEBCwUAMEUxCzAJBgNV
    ... YOUR CERTIFICATE CONTENT HERE ...
    ... INCLUDE FULL CERTIFICATE CHAIN IF NEEDED ...
    -----END CERTIFICATE-----

  # Your private key (keep this secure!)
  tls.key: |
    -----BEGIN PRIVATE KEY-----
    MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDXYZ8VhVVP3k
    ... YOUR PRIVATE KEY CONTENT HERE ...
    -----END PRIVATE KEY-----

# =============================================================================
# For wildcard certificates:
# If you have a wildcard cert (*.example.com), you can use it for bamboo.example.com
# Just create the secret once and reference it in multiple ingress resources
# =============================================================================

# =============================================================================
# For certificate with intermediate CA:
# If your certificate requires intermediate certificates, include them in tls.crt:
#
# stringData:
#   tls.crt: |
#     -----BEGIN CERTIFICATE-----
#     YOUR_DOMAIN_CERTIFICATE
#     -----END CERTIFICATE-----
#     -----BEGIN CERTIFICATE-----
#     INTERMEDIATE_CA_CERTIFICATE
#     -----END CERTIFICATE-----
#     -----BEGIN CERTIFICATE-----
#     ROOT_CA_CERTIFICATE (optional)
#     -----END CERTIFICATE-----
# =============================================================================

# =============================================================================
# Verify your certificate after creation:
#   kubectl get secret bamboo-tls -n bamboo -o yaml
#   kubectl describe secret bamboo-tls -n bamboo
#
# Test certificate validity:
#   kubectl get secret bamboo-tls -n bamboo -o jsonpath='{.data.tls\.crt}' | \
#     base64 -d | openssl x509 -text -noout
# =============================================================================
